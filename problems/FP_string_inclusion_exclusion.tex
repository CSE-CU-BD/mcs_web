\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{FP_string_inclusion_exclusion}
  \pcomment{same as FP_bijection_counting except for 1st part}
  \pcomment{verbatim from: S07 Final P5 with minor syntax edits}
\end{pcomments}

\pkeywords{
  combinatorics
  counting
  bijection
  inclusion-exclusion
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}

\bparts

\ppart
How many length $n$ binary strings are there in which
\texttt{011} occurs starting at the 4th position?

\begin{center}
\exambox{0.5in}{0.4in}{0in}
\end{center}

\examspace[0.5in}

\begin{solution}
  $2^{n-3}$
\end{solution}

\ppart
Let $A_i$ be the set of length $n$ binary strings in which
\texttt{011} occurs starting at the $i$th position.  (So $A_i$ is empty
for $i > n-2$.)  For $i < j$, the intersections $A_i \intersect A_j$ that
are nonempty are all the same size.  What is $\card{A_i \intersect A_j}$
in this case?

\begin{center}
\exambox{0.5in}{0.4in}{0in}
\end{center}

\examspace[0.5in}

\begin{solution}
$\mathbf{2^{n-6}}$.

To be nonempty, the copies of \texttt{011} at $i$ and $j$ use up 6
positions, leaving $n-6$ positions that can contain any pattern of
bits.  So $\card{A_i \intersect A_j} = 2^{n-6}$.
\end{solution}

\ppart\label{emptyij}
Let $t$ be the number of intersections $A_i \intersect A_j$ that are
nonempty, where $i < j$.  Express $t$ as a binomial coefficient.

\begin{center}
\exambox{0.6in}{0.4in}{0in}
\end{center}

\begin{solution}
  \[
  \binom{n-4}{2}.
  \]
  This is the same as asking how many ways there are to place two copies of
  \texttt{011} in a length $n$ binary sequence.  Since the copies can't
  overlap, this is the same as the number of sequences of $n-6$
  indistinguishable positions for single bits and 2 indistinguishable
  positions for the copies, which, by the Bookkeeper Principle, is
  $\binom{(n-6)+2}{2}$.
\end{solution}

\ppart How many length 9 binary strings are there that contain the
substring \texttt{011}?  You should express your answer as an integer
or as a simple expression which may include the constant, $t$, of
part~\eqref{emptyij}.

\hint Inclusion-exclusion for $\Card{\lgunion_1^7 A_i}$.

\begin{center}
\exambox{6.0in}{0.8in}{0in}
\end{center}

\examspace[2in]

\begin{solution}
\begin{equation}\label{9Ai7}
  \Card{\lgunion_1^9 A_i} = 7 \cdot 2^{6} - t \cdot 2^{3} +1 = 369.
\end{equation}

By Inclusion-exclusion
\begin{equation}\label{lgu19Ai}
  \Card{\lgunion_1^9 A_i} = \sum_1^9 \card{A_i} - \sum_{i \neq j} \card{A_i
    \intersect A_j} + \sum_{i \neq j \neq k} \card{A_i
    \intersect A_j \intersect A_k}.
\end{equation}

Since $A_8=A_9=\emptyset$, there are 7 terms in the first sum
in~\eqref{lgu19Ai}, and each term is $2^{n-3}$, namely the number of
patterns of the remaining $n-3$ bits besides the substring
\texttt{011}.

There are $t$ terms in the second sum in~\eqref{lgu19Ai}, each of size
$2^{n-6}$.

Finally, among the terms in the third sum,
\[
A_1 \intersect A_4 \intersect A_7 = \set{\mathtt{011011011}}
\]
and all the other intersections are empty.  This leads to
equation~\ref{9Ai7}.

\end{solution}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
