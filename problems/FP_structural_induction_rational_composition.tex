\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{FP_structural_induction_rational_composition}
  \pcomment{ARM 1/31/12}
\end{pcomments}

\pkeywords{
  structural_induction
  functions
  composition
  rational_function}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\providecommand{\RAF}{\ms{RAF}}

\begin{problem}

\begin{definition*}
The set $\RAF$ of \emph{rational functions} of one real variable is
the set of functions defined recursively as follows:

\textbf{Base cases:}
\begin{itemize}
\item The identity function, $\ide(r) \eqdef r$ for $r \in
  \reals$ (the real numbers), is an $\RAF$,
\item any constant function on $\reals$ is an $\RAF$.
\end{itemize}

\textbf{Constructor cases:}
If $f,g$ are $\RAF$'s, then so are
\begin{enumerate}
\item $f \mathbin{\mathbf{op}} g$, where $\mathbin{\mathbf{op}} = +, /, \cdot$. \label{RAF+*}
%\item the inverse function $f^{(-1)}$,\label{L:inversefunc}
%\item the composition $f \compose g$.\label{cmp}
\end{enumerate}
\end{definition*}
\bparts
\ppart
Prove by structural induction that $\RAF$ is closed under composition.
That is, using the induction hypothesis,
\[
P(h) \eqdef \forall g \in \RAF.\, h \compose g \in \RAF,
\]
prove that $P(h)$ holds for all $h \in \RAF$.  Make sure to indicate
explicitly
\begin{itemize}
\item each of the base cases, and

\item each of the constructor cases.
\hint A proof in terms of $\mathbin{\mathbf{op}}$ covers all the cases.
\end{itemize}

\examspace[3.5in]
\begin{solution}

\begin{proof}
  \inductioncase{base cases}: We must show $P(\ide_\reals)$ and
  $P(\text{constant-function})$.  But this follows immediately from
  the fact that $\ide_\reals \compose g = g$ and the composition of a
  constant function with any function, $g$, is constant.
  
  \inductioncase{constructor cases}: Given $e, f \in \RAF$, we may
  assume by structural induction that $P(e)$ and $P(f)$ both hold, and
  must prove $P(h)$ for $h= e \textbf{@} f$ in the three cases where
  $\textbf{@} = +$, $\cdot$, or $\div$.  But the same proof works for
  all three cases:
\[
(e \textbf{@} f) \compose g = (e \compose g) \textbf{@} (f \compose g)
\]
(by definition of composition), and since $(e \compose g), (f \compose
g) \in \RAF$ for all $g \in \RAF$ by hypothesis, so is their
combination using the operator $\textbf{@}$---that is, their
sum/product/quotient---by the constructor rule~\eqref{RAF+*}.  This
proves $P(h)$ for all three of the constructor cases $\textbf{@} =
+$, $\cdot$, or $\div$.

This completes all the constructor cases, and so $\forall h \in
\RAF.\, P(h)$ follows by structural induction.

\end{proof}

\end{solution}

\ppart Briefly indicate where a similar proof using the induction
hypothesis
\[
Q(g) \eqdef \forall h \in \RAF.\, h \compose g \in \RAF,
\]
would break down.

\examspace[1in]
\begin{solution}
The problem is that the identity used in the induction step of the
previous part, namely that composition distributes from the left over
each constructor operation \textbf{@}, breaks down for composition on
the right.  For example,
\[
h \compose (g_1 + g_2) = (h \compose g_1) + (h \compose g_2)
\]
fails when $h$ is nonlinear.  For example, if $h(x) \eqdef x^2$, and
$g_1=g_2= \ide_\reals$, then
\begin{align*}
{[}f \compose (g_1 + g_2)](r)
   &  = (2r)^2 = 4r^2\\
   & \neq 2r^2 = r^2 + r^2\\
   & = {[}(f \compose g_1) + (f \compose g_2)](r).
\end{align*}
So even though the conclusion $\forall g. Q(g)$ is true, a direct
proof using $Q(g)$ as the induction hypothesis quickly gets stuck.

\end{solution}

\eparts
\end{problem}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
