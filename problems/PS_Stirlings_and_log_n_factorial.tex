\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_Stirlings_and_log_n_factorial}
  \pcomment{from: S09.cp9m,9t}
  \pcomment{from: F03.ps6}
\end{pcomments}

\pkeywords{
  asymptotics
  Stirlings_formula
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
  Let $f$, $g$ be nonnegative real-valued functions such that $\lim_{x \to
    \infty} f(x) = \infty$ and $f \sim g$.

\bparts

\ppart Give an example of $f,g$ such that $\QNOT(2^f \sim 2^g)$.

\begin{solution}

\begin{align*}
f(n) & \eqdef n+1\\
g(n) & \eqdef n.
\end{align*}

Then $f \sim g$ since $\lim (n+1)/n = 1$, but $2^f= 2^{n+1} = 2\cdot 2^n =
2\cdot 2^g$ so
\[
\lim \frac{2^f}{2^g} = 2 \neq 1.
\]

\end{solution}

\ppart\label{logfsim} Prove that $\log f \sim \log g$.

\begin{solution}

\begin{align*}
\lim \frac{f}{g} & = 1\\
\log \lim \frac{f}{g} & = \log 1\\
\lim \log\paren{\frac{f}{g}} & = 0\\
\lim \log f - \log g & = 0\\
\lim \frac{\paren{\log f - \log g}}{\log g} & = 0\\
\lim \frac{\log f}{\log g} - \frac{\log g}{\log g} & = 0\\
\lim \frac{\log f}{\log g} - 1 & = 0\\
\lim \frac{\log f}{\log g} & = 1
\end{align*}


\begin{align*}
\lim \frac{\log f}{\log g}
& = \lim \frac{(\log f)'}{(\log g)'} 
       & \text{(L'Hospital's rule)}\\
& = \lim \frac{1/f}{1/g} \\
& =  \lim \frac{1}{f/g} \\
& =  \frac{1}{\lim (f/g)} \\
& = 1/1 = 1.
\end{align*}

\end{solution}

\ppart Use Stirling's formula to prove that in fact
\[
\log (n!) \sim n \log n
\]

%\hint $f \sim g$ for $f,g \geq 1$ implies $\log f \sim \log g$.

\begin{solution}
Taking logs of both sides of Stirling's formula, we have
\begin{align*}
n! & \sim \sqrt{2 \pi n}\paren{\frac{n}{e}}^n  & \text{(Stirling)}\\
\log (n!)
& \sim n \log\paren{\frac{n}{e}} + \log \sqrt{2 \pi n} & \text{(part~\eqref{logfsim}})\\
& = n \log n - n \log e + \log \sqrt{2 \pi n}\\
& \sim n \log n.
\end{align*}

The final step follows from the fact that
\begin{align*}
\lim_{n \to \infty} \frac{n \log n - n \log e + \log \sqrt{2 \pi n}}{n \log n} & =
\lim_{n \to \infty} \paren{\frac{n \log n}{n \log n} - \frac{n \log e}{n \log n}
+ \frac{\log \sqrt{2 \pi}}{n \log n} + \frac{(\log n)/2}{n \log n}\\
& = 1 - \lim_{n \to \infty} \frac{\log e}{\log n} + \lim_{n \to \infty}
\frac{\log \sqrt{2 \pi}}{n \log n} +  \lim_{n \to \infty} \frac{1}{2n}\\
& = 1 - 0 - 0 - 0 = 1.
\end{align*}

\end{solution}

\eparts
\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
