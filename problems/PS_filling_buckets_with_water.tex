\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_filling_buckets_with_water}
  \pcomment{from: F09.ps4, F02.ps5}
  \pcomment{edited by ARM 2/26/11 and 4/24/11}
\end{pcomments}

\pkeywords{
	state_machines
        invariant
        jug
        die_hard
        gcd
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Let's extend the jug filling scenario of
Section~\bref{jug_invar_subsubsec} to three jugs and a receptacle.
Suppose the jugs can hold $a$, $b$, and $c$ gallons of water,
respectively.

The receptacle can be used to store an unlimited amount of water, but
has no measurement markings.  Excess water can be dumped into the
drain.  Among the possible moves are:

\begin{enumerate}

\item\label{hose-bucket} fill a bucket from the hose,

\item pour from the receptacle to a bucket until the bucket is full
or the receptacle is empty, whichever happens first,

\item empty a bucket to the drain,

\item\label{bucket-receptacle} empty a bucket to the receptacle,

\item pour from one bucket to another until either the first is empty or the second is full,

\end{enumerate}

\bparts

\ppart
Model this scenario with a state machine.  (What are the states?  How does
a state change in response to a move?)

\begin{solution}
The states are quadruples $(w,x,y,z)$ which give the current amount of
water in the bucket three buckets and the receptacle, respectively.
The initial state is $(0,0,0,0)$.

\TBA{rest of the definition.}

\begin{editingnotes}
\TBA{REVISE THIS TWO BUCKET VERSION TO THREE BUCKETS}

The moves make the following transitions:
\begin{enumerate}
\item fill a bucket from the hose
\[
(x,y,z) \rightarrow \left \{ \begin{array}{l}
(a,y,z) \mbox{ if filling A from the hose } \\
(x,b,z) \mbox{ if filling B from the hose }
\end{array} \right.
\]

\item pour from the receptacle to a bucket until the bucket is full
or the receptacle is empty, whichever happens first
\[
(x,y,z) \rightarrow \left \{ \begin{array}{l}
(a,y,z-(a-x)) \mbox{ if pouring to A and } z \geq (a-x) \\
(x+z,y,0) \mbox{ if pouring to A and } z < (a-x) \\
(x,b,z-(b-y)) \mbox{ if pouring to B and } z \geq (b-y) \\
(x,y+z,0) \mbox{ if pouring to B and } z < (b-y)
\end{array} \right.
\]

\item empty a bucket to the drain
\[
(x,y,z) \rightarrow \left \{ \begin{array}{l}
(0,y,z) \mbox{ if emptying A to the drain } \\
(x,0,z) \mbox{ if emptying B to the drain }
\end{array} \right.
\]

\item empty a bucket to the receptacle
\[
(x,y,z) \rightarrow \left \{ \begin{array}{l}
(0,y,z+x) \mbox{ if emptying A to the receptacle } \\
(x,0,z+y) \mbox{ if emptying B to the receptacle }
\end{array} \right.
\]

\item pour from $A$ to $B$ until either $A$ is empty or $B$ is full,
whichever happens first
\[
(x,y,z) \rightarrow \left \{ \begin{array}{l}
(0,y+x,z) \mbox{ if } x < (b-y) \\
(x-(b-y),b,z) \mbox{ if } x \geq (b-y)
\end{array} \right.
\]

\item pour from $B$ to $A$ until either $B$ is empty or $A$ is full,
whichever happens first
\[
(x,y,z) \rightarrow \left \{ \begin{array}{l}
(x+y,0,z) \mbox{ if } y < (a-x) \\
(a,y-(a-x),z) \mbox{ if } y \geq (a-x)
\end{array} \right.
\]
\end{enumerate}
\end{editingnotes}

\end{solution}


\ppart \label{gcd-iff}
Prove that Bruce can get $k\in\naturals$ gallons of water into the
receptacle using the above operations only if $\gcd(a,b,c) \divides k$.

\begin{solution}
\TBA{solution}
\end{solution}

\ppart Prove conversely, that if $\gcd(a,b,c) \divides k$, then Bruce
can get actually get $k$ gallons of water into the receptacle.

\begin{solution}
\TBA{solution}
\end{solution}

\eparts
\end{problem}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
