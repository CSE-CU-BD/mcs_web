\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{FP_graph_logic_probability}
  \pcomment{from: S08.final}
\end{pcomments}

\pkeywords{
  graph
  logic
  probability
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem} \textbf{Graphs, Logic \& Probability}

  Let $G$ be an undirected simple graph with $n>3$ vertices.  \iffalse
  Suppose we want to define define the predicate $E(x,y)$ to be true when
  $G$ has an edge between $x$ and $y$ and the predicate \fi Let $E(x,y)$
  mean that $G$ has an edge between vertices $x$ and $y$, and let $P(x,y)$
  mean that there is a length 2 path in $G$ between $x$ and $y$.

\bparts

\ppart Explain why $E(x,y)$ implies $P(x,x)$.

\begin{solution}[\vspace{1.5in}]
Going back and forth on edge $\edge{x}{y}$ is a
  length two path from $x$ to $x$.  
\end{solution}

\ppart Circle the mathematical formula that best expresses the
definition of $P(x,y)$.

\begin{itemize}
\item $P(x,y) \eqdef \exists z.\ E(x,z) \QAND\ E(y,z)$
\vspace{0.15in}
\item $P(x,y) \eqdef x \neq y \QAND\ \exists z.\ E(x,z) \QAND\ E(y,z)$
\vspace{0.15in}
\item $P(x,y) \eqdef \forall z.\ E(x,z) \QOR\ E(y,z)$
\vspace{0.15in}
\item $P(x,y) \eqdef \forall z.\ x \neq y \QIMPLIES\ [E(x,z) \QOR\ E(y,z)]$
\end{itemize}

\begin{solution}
$P(x,y) \eqdef \exists z.\ E(x,z) \QAND\ E(z,y)$
\end{solution}

For the following parts~\eqref{EE}--\eqref{3cycle}, let $V$ be a fixed set
of $n>3$ vertices, and let $G$ be a graph with these vertices constructed
randomly as follows: for all distinct vertices $x,y \in V$, independently
include edge $\edge{x}{y}$ as an edge of $G$ with probability $p$.  In
particular, $\pr{E(x,y)} = p$ for all $x \neq y$.

\ppart \label{EE} \; For distinct vertices $w$, $x$, $y$ and $z$ in $V$, 
circle the event pairs that are independent.

\begin{enumerate}

\item $E(w,x)$ versus $E(x,y)$\label{EE1}
\insolutions{\textbf{TRUE}}
\vspace{0.15in}
\item\label{wz-indep} $\paren{E(w,x) \QAND\ E(w,y)}$ versus
      $\paren{E(z,x) \QAND\ E(z,y)}$
\insolutions{\textbf{TRUE}}
\vspace{0.15in}
\item $E(x,y)$ versus $P(x,y)$
\insolutions{\textbf{TRUE}}
\vspace{0.15in}
\item $P(w,x)$ versus $P(x,y)$ 
\insolutions{\textbf{FALSE}}
\vspace{0.15in}
\item $P(w,x)$ versus $P(y,z)$
\insolutions{\textbf{FALSE}}
\end{enumerate}

\examspace

\ppart \label{nottwopath} \; Write a simple formula in terms of $n$ and
$p$ for $\pr{\text{not } P(x,y)}$, for distinct vertices $x$ and $y$ in
$V$.

\hint Use part~\eqref{EE}, item~\ref{wz-indep}.
 
\begin{solution}[\vspace{4in}] 
Let $Z \eqdef V - \set{x,y}$ be the set of all
  the vertices other than $x$ and $y$.

\begin{align*}
\pr{\text{not } P(x,y)}
  & = \pr{\QAND\_{z \in Z} \bar{E(x,z) \QAND\ E(y,z)}} & \\
  & = \prod_{z \in Z} \pr{\bar{E(x,z) \QAND\ E(y,z)}} &
    \text{(indep. from item~\eqref{EE}~\ref{wz-indep}.)}  \\
  & = \prod_{z \in Z} (1-\pr{E(x,z)}\cdot\pr{E(y,z)}) & 
    \text{(indep. from item~\eqref{EE}~\ref{EE1}.)}\\
  & = \prod_{z \in Z} (1-p^2) & \\
  & = (1-p^2)^{n-2} &
\end{align*}
\end{solution}

\ppart \label{3cycle} \; What is the probability that two distinct
vertices $x$ and $y$ lie on a three-cycle in $G$?  Answer with a simple
expression in terms of $p$ and $r$, where $r \eqdef \pr{\text{not }
  P(x,y)}$ is the correct answer to part~(\ref{nottwopath}).

\hint Express $x$ and $y$ being on a three-cycle as a simple formula
involving $E(x,y)$ and $P(x,y)$.

\begin{solution}[\vspace{3in}]
$x$ and $y$ lie on a three-cycle iff $E(x,y) \QAND\
P(x,y)$.

Since $E(x,y)$ and $P(x,y)$ are independent,
\begin{align*} 
\pr{E(x,y) \QAND\ P(x,y)} & = \pr{E(x,y)} \cdot \pr{P(x,y)} \\
                        & = p (1-r) .
\end{align*}
Substituting in for $r$ (not asked), we get
\[\pr{E(x,y)\QAND\ P(x,y)} = p (1-(1-p^2)^{n-2}).\]
\end{solution}

\eparts
\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
