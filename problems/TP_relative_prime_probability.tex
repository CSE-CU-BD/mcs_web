\documentclass[problem]{mcs}

\begin{pcomments}
    \pcomment{TP_relative_prime_probability}
    \pcomment{ARM 5/17/15}
\end{pcomments}

\pkeywords{
  relatively_prime
  probability
}

\begin{problem}
Suppose $p$ and $q$ are distinct 400 digit primes, and let $n = pq$.

\bparts

\ppart Which of the following expressions is the smallest guaranteed
upper bound on the probability that a random integer in the interval
$\Zintvco{0}{n}$ is not relatively prime to $n$?  (You may assume the
fact that there is a prime number in the interval $\Zintv{m}{2m}$ for
all positive integers $m$.)

\begin{itemize}
\iffalse
\item $10^{-399}$
\item $10^{-400}$
\item $10^{-799}$
\item $10^{-800}$
\fi

\item $2 \cdot 10^{-399}$
\item $2 \cdot 10^{-400}$
\item $2 \cdot 10^{-799}$
\item $2 \cdot 10^{-800}$

\end{itemize}

\begin{solution}
$2 \cdot 10^{-399}$.

The number of integers in $\Zintvco{0}{n}$ that are not relatively
prime to $n$ is $n-\phi(n) = pq - (p-1)(q-1) = p + q - 1$, so the
probability, $r$, of randomly choosing one of these is
\[
r = (p + q - 1)/n = 1/q + 1/p - 1/pq
\]
Since any 400 digit number is $\geq 10^{399}$, we have $r \leq 2
10^(-399}$ (we ignore the negligible $-1/pq < -10^{-800}$).

Also, since there are primes $p,q < 2 \cdot 10^{399}$, so it is
possible that $r > 1/2 \cdot 10^{-399} + 1/2 \cdot 10^{-399} =
10^{-399}$, so the remaining bounds are too small.
\end{solution}

\end{problem}

\endinput
