\documentclass[problem]{mcs}

\begin{pcomments}
    \pcomment{RSA_reversed}
\end{pcomments}

\begin{problem}

%% type: short-answer
%% title: RSA reversed

\bparts

Consider communication between server Sierra and client Charlie where
Sierra generates the public key $(e,n)$ and the private key $(d,n)$ for RSA.
When Charlie wants to send Sierra a message $m$ secretly,
Charlie can send the encrypted message $m^*=\rem{m^{e}}{n}$ to Sierra.
Sierra can reproduce $m$ from $m^*$ by computing $m=\rem{m^{*d}}{n}$ and
no one else can read $m^*$ because they do not know the private key.
However, since the public key is known to everyone,
a third party opponent Oscar can pretend to be Charlie 
and send Sierra a message encrypted by the public key.
In this problem we will see RSA can also prevent forged messages 
when the keys are used in reverse.

\ppart
Using the same keys Sierra had generated for RSA,
consider when Sierra wants to send Charlie a message $m$.
Sierra can encrypts $m$ using the private key $(d, n)$ to produce
$m^*=\rem{m^{d}}{n}$ and sends $m^*$ to Charlie.
Explain how Charlie can reproduce the original message $m$
with only $m^*$ and $(e,n)$ and why this method will return $m$.

\begin{solution}
Charlie can reproduce $m$ by computing $m=\rem{m^{*e}}{n}$. 
Since the normal RSA scheme decrypts messages using the property
$\rem{\rem{m^{e}}{n}^d}{n} = \rem{m^{ed}}{n} = m$,
with the keys reversed, the message can still be decrypted because that
$\rem{\rem{m^{d}}{n}^e}{n} = \rem{m^{de}}{n} = m$.
\end{solution}

\ppart
%n = p * q = 29 * 37 = 1073 
%phi(n) = 28 * 26 = 1008
%e,d = 605,5 
Given the public key (5, 1073), and the encrypted message 33, 
what is the original message?

\begin{solution}
The original message is $\rem{33^5}{1073} = 937$
\end{solution}

Charlie can be confident that $m$ came from Sierra because the message
is encrpyted with the private key which only Sierra knows.

%\ppart
%Explain in words why $B$ can be confident that this message is not forged?
%
%\begin{solution}
%Because only $A$ knows the private key.
%\end{solution}

\eparts

\end{problem}

\endinput
