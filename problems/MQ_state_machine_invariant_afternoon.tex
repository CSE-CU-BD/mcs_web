\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{MQ_state_machine_multiply}
  \pcomment{S07.miniquiz-3-07}
  \pcomment{MQ version of CP_state_machine_multiply}
  \pcomment{renamed from PS_state_machine_multiply 2/21/11}
\end{pcomments}

\pkeywords{
  state_machines
  termination
  partial_correctness
  invariant
  algorithm
  multiply
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
%Tests state machine understanding, invariant method, termination arguments.
%IMPORTANT: If reusing this problem, the second part should be split into 2 parts:
% 1. Prove the invariant., 2. Apply invariant principle...

The following state machine describes a procedure that terminates with the
product of two nonnegative integers $x$ and $y$ in register $a$.  Its
states are triples of nonnegative integers $(r,s,a)$.  The initial state
is $(x,y,0)$.  The transitions are given by the rule that for $s>0$:
\[
(r,s,a)\rightarrow\begin{cases}
        (2r,s/2,a) &\text{if $s$ is even},\\
        (2r,(s-1)/2,a+r) &\text{otherwise}.
       \end{cases}
\]

Circle the predicates below that are preserved invariants for
this state machine:
\begin{itemize}
\item $[a > 0]$
\item $[r < 0]$
\item $[r = 0]$
\item $[s+a = xy]$
\item $[r+a = s]$
\item $[rs+a = xy]$
\end{itemize}

\begin{solution}
$[rs+a = xy]$,  and $[r=2r+1]$ are invariants.  The second of these
  is vacuously invariant because it is always false.
\end{solution}

\begin{solution}
$[a > 0]$ is a preserved invariant since $a$ stays te same or increases by $r\geq 0$ at each transition.

$[r < 0]$ is a preserved invariant since it is always false.

$[r = 0]$ is a preserved invariant since $r$ just gets doubled at each transition.

$[rs+a = xy]$ is the preserved invariant that could be used to verify
  partial correctness.

But $[s+a = xy]$ is not preserved, because, for example, $(1,5,0) \movesto (2,2,1)$, and
likewise $[r+a = s]$ are preserved because, for example, $(1,1,0) \movesto (2,0,0)$

\end{solution}

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
