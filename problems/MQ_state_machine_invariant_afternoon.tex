\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{MQ_state_machine_multiply}
  \pcomment{S07.miniquiz-3-07}
  \pcomment{MQ version of CP_state_machine_multiply}
  \pcomment{renamed from PS_state_machine_multiply 2/21/11}
\end{pcomments}

\pkeywords{
  state_machines
  termination
  partial_correctness
  invariant
  algorithm
  multiply
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
%Tests state machine understanding, invariant method, termination arguments.
%IMPORTANT: If reusing this problem, the second part should be split into 2 parts:
% 1. Prove the invariant., 2. Apply invariant principle...

The following state machine describes a procedure that terminates with the
product of two nonnegative integers $x$ and $y$ in register $a$.  Its
states are triples of nonnegative integers $(r,s,a)$.  The initial state
is $(x,y,0)$.  The transitions are given by the rule that for $s>0$:
\[
(r,s,a)\rightarrow\begin{cases}
        (2r,s/2,a) &\text{if $s$ is even},\\
        (2r,(s-1)/2,a+r) &\text{otherwise}.
       \end{cases}
\]

%\iffalse
%\solution{
%\medskip
%\textbf{Solution:}
%\begin{description}
%\item $Q=\{(r,s,a,x, n) | r,s,a,x, n\in \mathbb{N}\}$
%\item $Q_0=\{(x, n,0,x, n)\}$
%\item $\delta: (r,s,a,x, n)\rightarrow (3r,s',a',x, n)$, where \\
%If $s \equiv 0 \pmod{3}$: $s'=s/3$, and $a'=a$ \\
%If $s \equiv 1 \pmod{3}$: $s'=(s-1)/3$, and $a'=a+r$\\
%If $s \equiv 2 \pmod{3}$: $s'=(s-2)/3$, and $a'=a+2r$
%\end{description}
%}
%\fi

Circle the predicates below that are invariant for
this state machine:
\begin{itemize}
\item $P((r,s,a)) \eqdef\quad [rs+a = xy]$
\item $P((r,s,a)) \eqdef\quad [r = 2r+1]$
\item $P((r,s,a)) \eqdef\quad [s+a = xy]$
\item $P((r,s,a)) \eqdef \quad [r+a = s]$

\end{itemize}

\begin{solution}
$[rs+a = xy]$ and $[r=2r+1]$ are invariants.  The second of these
  is vacuously invariant because it is always false.
\end{solution}

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
