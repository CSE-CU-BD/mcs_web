\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_bijective_FLT_S16}
  \pcomment{ARM revise PS_bijective_FLT, 4/15/16}
  \pcomment{S16.ps7, S13.ps10, F11.MQ}
\end{pcomments}

\pkeywords{
  counting
  Fermat
  congruence
  equivalence
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
Fermat's Little Theorem~\bref{fermat_little}\footnote{This Theorem is usually stated as
\[
 a^{p-1}\equiv 1\pmod{p},
\]
for all primes $p$ and integers $a$ not divisible by $p$.  This
follows immediately from~\eqref{apeqvap} by canceling $a$.}
asserts that
\begin{equation}\label{apeqvap}
 a^p\equiv a\pmod{p}
\end{equation}
for all primes $p$ and nonnegative integers $a$.  This is immediate
for $a=0,1$ so we assume that $a \geq 2$.

This problem offers a proof of~\eqref{apeqvap} by counting strings
over a fixed alphabet with $a$ characters.

\bparts

\ppart\label{countak} How many length-$k$ strings are there over an
$a$-character alphabet? \hfill\examrule
\begin{solution}
$a^k$.
\end{solution}
How many of these are strings use more than one character? \hfill\examrule
\begin{solution}
$a^k-a$.

For each of the $a$ characters, there is exactly one length-$k$
string using only that character.
\end{solution}

\eparts

\medskip

Let $z$ be a length $k$ string.  The \emph{length-$n$ rotation} of $z$
is the string $yx$, where $z = xy$ and the length, $\lnth{x}$, of $x$
is $\remainder(n,k)$.

\bparts

\ppart\label{rotateagain} Verify that if $u$ is a length-$n$ rotation
of $z$, and $v$ is a length-$m$ rotation of $u$, then $v$ is a
length-($n+m$) rotation of $z$.

\begin{solution}
Suppose $z = wxy$ where $\lnth{w} = n, \lnth{x} = m$.  Then $u = xyw$,
and so $v = ywx$.  But $\lnth{wx} = n+m$, so $v$ is the length-$n+m$
rotation of $z$.  This argument applies to $n,m,n+m > \lnth{z}$ by
taking remainders on division by $\lnth{z}$.
\begin{staffnotes}
\TBA{Explain about remainders more clearly?}
\end{staffnotes}
\end{solution}

\ppart Let $\approx$ be the ``is a rotation of'' relation on strings.
That is,
\[
v \approx z \quad \QIFF\quad v\ \text{is a length-$n$ rotation of}\ z
\]
for some $n \in \nngint$.  Prove that $\approx$ is an equivalence
relation.

\begin{solution}
\begin{proof}
Reflexivity follows since everything is a length 0 rotation of itself.
Symmetry follows because $v$ is a length $m$ rotation of $z$ iff $z$
is a length $\lnth{z} - \remainder(m,\lnth{z})$ rotation of $v$.
Transitivity follows from part~\eqref{rotateagain}.
\end{proof}
\end{solution}

\ppart\label{xyyxm*} Prove that if $xy=yx$ then $x$ and $y$ each consist of
repetitions of some string $u$.  That is, if $xy=yx$, then $x,y \in
u^*$ for some string $u$.

\hint By induction on the length $\lnth{xy}$ of $xy$.

\inhandout{(Old hint leading to more cumbersome proof: Let $u$ be the
  shortest positive length string such that $uy=yu$.)}

\begin{solution}
\begin{proof}
By strong induction with the induction hypothesis
\[
P(n) \eqdef \forall \text{strings}\ x,y. \lnth{xy} = n \QIMPLIES\ \exists u.\ x,y \in u^*.
\]

\inductioncase{Base case} ($n=0$).  Immediate.

\inductioncase{Induction step}.  Suppose $\lnth{xy} = n+1$ and
$xy=yx$.  We must now show that $x,y \in u^*$ for some string $u$.

Since $x$ and $y$ are interchangeable in the hypotheses, we may assume
that $\lnth{x} \leq \lnth{y}$.  If $\lnth{x} = 0$, then letting $u
\eqdef y$ yields $x,y\in u*$, so we may assume $\lnth{x} > 0$.

Now $xy=yx$ implies that $y = x y'$ for some string $y'$.  So we have
\[
x(xy')= xy = yx = (xy')x = x(y'x),
\]
and therefore
\[
xy' = y'x.
\]
Also $\lnth{xy'} < \lnth{xy}$.  By induction hypothesis, we have
\[
x,y' \in u^*
\]
for some string $u$.  Since $y = xy'$ is a concatenation of strings in
$u^*$, we conclude that $y\in u^*$.
\end{proof}

\end{solution}

\ppart\label{exactlyp} Conclude that if $p$ is prime and $z$ is a
length-$p$ string containing at least two different characters, then
$z$ is equivalent under $\approx$ to exactly $p$ strings (counting
itself).

\begin{solution}
By part~\eqref{xyyxm*}, $z \in u^*$ for some string $u$, and $z$ is
$\approx$-equivalent to exactly $\lnth{u}$ strings.  In particular,
$\lnth{z}$ is a multiple of $\lnth{u}$.

But $\lnth{z} = p$, so $\lnth{u}$ must be 1 or $p$, and since $z$ has
more at least two different characters, $\lnth{u} \neq 1$.  So $z$ is
equivalent to exactly $p$ strings.
\end{solution}

\ppart Conclude from parts~\eqref{countak} and~\eqref{exactlyp} that
$p \divides (a^p -a$), which proves Fermat's Little
Theorem~\eqref{apeqvap}.

\begin{solution}
From part (a), there are $a^p-a$ length-$p$ strings made from an
alphabet with $a$ characters that contain at least 2 different
characters. From (e), if $p$ is prime, a length-$p$ string of at least
two different characters is equivalent under $\approx$ to exactly $p$
other strings. Thus, if $p$ is prime, then $p \divides a^p-a$ and
therefore $a^p \equiv a \pmod{p}$, as desired.
\end{solution}
\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
