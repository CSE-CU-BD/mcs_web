\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_expected_time_to_TTH}
  \pcomment{from: SP11}
\end{pcomments}

\pkeywords{
  infinite_sample_space
  total_expectation
  subtree
  tree_diagram
}

\begin{problem}
A coin has a probability $p$ of coming up H. Consider the problem of tossing it and waiting
for a TTH sequence to appear.  If $p = 0$ or $p = 1$ we know the sequence will never 
appear, so the time it takes to see the sequence will depend on $p$. 

Let the random variable $N_\mathtt{TTH}$ be the number of coin tosses it takes to see the sequence TTH.

For what $p$ do we obtain the shortest possible mean time to failure possible, and what is
that shortest possible mean time to failure?

\begin{solution}
We can draw the event tree for the coin tosses, denoted by D, 
using the notation seen in class problems.

$$D = H\cdot D + T\cdot (H\cdot D + T\cdot G)$$. 

With $G = H + T\cdot G$, which is a familiar tree shown in class.

Abusing a bit of the notation, we can conclude:

$$D = H\cdot D + T\cdot H\cdot D + T\cdot T\cdot G$$.

Now we compute $\expect{N_\mathtt{TTH}}$

\[
\expect{N_\mathtt{TTH}} = p\left( 1 + \expect{N_\mathtt{TTH}} \right)  + 
(1-p)p \left( 2 + \expect{N_\mathtt{TTH}} \right) + 
\left( 1-p \right)^2 \left( 2 + \expect{N_\mathtt{H}}  \right)
\]

We know $\expect{N_\mathtt{H}} = 1/p$, so we can focus on the rest of the tree.

\[ 
\expect{N_\mathtt{TTH}} = (p + (1-p)p) \expect{N_\mathtt{TTH}} + p + 2(1-p)p + (1-p)^2( 2 + 1/p)
\]

Notice how the $2 + 1/p$  term corresponds to the mean time to failure of the variable
given we see TT at the start. Also, if $p = 0$ the $1/p$ term grows infinite, whereas
if $p = 1$ the $(1-p)^2$ term grows infinite.

\begin{align*}
\lefteqn{\expect{N_\mathtt{TTH}}}\\
& = \dfrac{p + 2(1-p)p + (1-p)^2( 2 + 1/p)}{1 - p - (1-p)p}\\
& = \dfrac{p(3 - 2p)}{(1-p)^2} + 2 + 1/p
\end{align*}

Now that we have $\expect{N_\mathtt{TTH}}$ in terms of $p$, we can minimize it using basic calculus.

The derivative of $\expect{N_\mathtt{TTH}}}$ with respect to $p$ is 

\[
\dfrac{1 - 3p }{(p-1)^3p^2}
\]

So the function is minimized at $p = 1/3$. In this case, the expected time to see TTH is $27/4 = 7 - 1/4$.
Compare this to when $p = 1/2$, in that case the expected time is $8$.

\end{solution}
\end{problem}