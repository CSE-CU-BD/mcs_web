\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_binary_gcd}
  \pcomment{DRAFT by ARM 4/24/11 based on Shoup}
\end{pcomments}

\pkeywords{
  strong_induction
  GCD
  binary_GCD
  state_machine
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
  The binary-GCD state machine computes the GCD of $a$ and $b$ using only
  division by 2 and subtraction, which makes it run very efficiently on
  hardware that uses binary representation of numbers.  In practice, it
  runs more quickly than the Euclidean algorithm state
  machine~(\bref{euclid_transition}).

\begin{align*}
\text{states} & \eqdef \naturals^3\\
\text{start state} & \eqdef (a, b, 1)
             & \text{(where $a > b >0$)}\\
\text{transitions} & \eqdef \text{ if } \min(x,y) > 0, \text{ then } (x,  y, e) \movesto\\
     &\qquad \text{the first possible state according to the rules:}\\
     &\qquad
       \begin{cases}
       (1, 0, ex)     & \text{(if $x = y$)}\\
       (1, 0, e)      & \text{(if $y=1$)},\\
       (x/2, y/2, 2e) & \text{(if $2 \divides x$ and $2 \divides y$)},\\
       (y, x, e)      & \text{(if $y>x$)}\\
       (x, y/2, e)    & \text{(if $2 \divides y$)}\\
       (x/2, y, e)    & \text{(if $2 \divides x$)}\\
       (x-y,y,e)      & \text{(otherwise)}.
       \end{cases}
\end{align*}

\bparts 

\ppart Prove that if this machine reaches a ``final'' state $(x,y,e)$
in which no transition is possible, then $e = \gcd(a,b)$.

\begin{solution}
Invariant is $\gcd(a,b) = e\gcd(x,y)$.

\begin{editingnotes}
\TBA{needs completion}
\end{editingnotes}

\end{solution}

\ppart Prove that the machine reaches a final state in at most
$3+2\log \max(a,b)$ transitions.

\hint Strong induction on $\max(a,b)$.

\begin{solution}

\begin{editingnotes}
\TBA{Check the constants 3 and 2, and complete the solution}
\end{editingnotes}

\end{solution}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput

