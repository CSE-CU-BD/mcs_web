\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{MQ_counting_paths_with_obstacles}
\end{pcomments}

\pkeywords{
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
A spacecraft is traveling through otherwise-empty three-dimensional space.
It can move along only one dimension at a time, stepping precisely one unit in the positive
direction along that dimension with each movement.  For any two points, $P$ and $Q$, in
space, let $p_{P,Q}$ denote the number of distinct paths the spacecraft can
follow to go from $P$ to $Q$.

\begin{problemparts}

\problempart
Let $P$ and $Q$ have coordinates $(x_P,y_P,z_P)$ and $(x_Q,y_Q,z_Q)$, respectively.
Assuming that $p_{P,Q}$ is positive, express $p_{P,Q}$ \textbf{as a single multinomial coefficient}. 
\examspace[2in]
\begin{solution}
\[p_{P,Q}=\binom{(x_Q-x_P)+(y_Q-y_P)+(z_Q-z_P)}{x_Q-x_P,y_Q-y_P,z_Q-z_P}\]
\end{solution}

\problempart
Suppose there exist five points in space, $A$, $B$, $C$, $D$, and $E$, such that it is possible for the spacecraft to travel from $A$ to $B$, from $B$ to $C$, from $C$ to $D$, and 
from $D$ to $E$.  Write an expression for the number of distinct paths the spacecraft can follow to go from
$A$ to $E$ while \textbf{avoiding} $B$, $C$, and $D$.  Your expression \textbf{must} be written entirely in terms of symbols of the form $p_{P,Q}$,
where $P,Q\in\set{A,B,C,D,E}$.\\\\
\hint{Inclusion-Exclusion.}
\examspace[3in]
\begin{solution}
First, note that since is possible for the spacecraft to travel from $A$ to $B$, from $B$ to $C$, from $C$ to $D$, and
from $D$ to $E$, therefore paths exist from $A$ to each of $A$,$B$,$C$,$D$, and $E$, from $B$ to each of $C$,$D$,and $E$,\ldots, and from $E$ to $E$. 

Let $S$ denote the set of all paths from $A$ to $E$.  Clearly, $|S| = p_{A,E}$.

Let $S_X$ denote the set of all paths that go from $A$ to $E$, through $X$, where $X\in\set{B,C,D}$.  Evidently, $|S_X|=p_{A,X}p_{X,E}$.

Now, $S_X\cap S_Y$ is the set of paths that go from $A$ to $E$, through both $X$ and $Y$, where $X,Y\in\set{B,C,D}$.  Obviously,
$|S_B\cap S_C| = p_{A,B}p_{B,C}p_{C,E}$, $|S_B\cap S_D| = p_{A,B}p_{B,D}p_{D,E}$, and $|S_C\cap S_D| = p_{A,C}p_{C,D}p_{D,E}$.

Also, $S_B\cap S_C\cap S_D$ is the set of all paths that go from $A$ to $E$, through all three of $B$, $C$, and $D$.  Obviously,
$|S_B\cap S_C\cap S_D| = p_{A,B}p_{B,C}p_{C,D}p_{D,E}$.

Now, the set of paths that go from $A$ to $E$ and pass through at least one of $B$, $C$, and $D$, is just $S_B\cup S_C\cup S_D$.
By inclusion-exclusion,
\begin{align*}
|S_B\cup S_C\cup S_D| = &|S_B| + |S_C| + |S_D| - |S_B\cap S_C| - |S_B\cap S_D| - |S_C\cap S_D| + |S_B\cap S_C\cap S_D|\\
                      = &p_{A,B}p_{B,E} + p_{A,C}p_{C,E} + p_{A,D}p_{D,E}\\  
                        &- p_{A,B}p_{B,C}p_{C,E} - p_{A,B}p_{B,D}p_{D,E} - p_{A,C}p_{C,D}p_{D,E} + p_{A,B}p_{B,C}p_{C,D}p_{D,E}
\end{align*}

Let $R$ denote the set of all paths from $A$ to $E$ that go through neither $B$, nor $C$, nor $D$.  Evidently, $S = R\cup\paren{S_B\cup S_C\cup S_D}$ and $R\cap\paren{S_B\cup S_C\cup S_D}=\emptyset$.
Therefore $|S| = |R| + |S_B\cup S_C\cup S_D|$, so the number of distinct paths the spacecraft can follow to go from $A$ to $E$ while avoiding $B$, $C$, and $D$ is
\begin{align*}
|R| = &|S| - |S_B\cup S_C\cup S_D| \\
    = &p_{A,E} - p_{A,B}p_{B,E} - p_{A,C}p_{C,E} - p_{A,D}p_{D,E} \\ 
      &+ p_{A,B}p_{B,C}p_{C,E} + p_{A,B}p_{B,D}p_{D,E} + p_{A,C}p_{C,D}p_{D,E} - p_{A,B}p_{B,C}p_{C,D}p_{D,E}
\end{align*}

\end{solution}

\end{problemparts}

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
