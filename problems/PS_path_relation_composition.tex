\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_path_relation_composition}
  \pcomment{from: digraph notes}
\end{pcomments}

\pkeywords{
  binary_relation
  composition
  path_relation
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
%Prove Lemma~\bref{lem:Rn-paths}, Namely,

Let $R$ be a binary relation on a set $A$.  Then $R^n$ denotes the
composition of $R$ with itself $n$ times.  Let $G_R$ be the digraph
associated with $R$.  That is, $A$ is the set of vertices of$G_R$ and
$R$ is the set of directed edges.
Let $R^{(n)}$ denote the
length $n$ path relation $G_R$, that is,
\[
a \mrel{R^{(n)}} b \eqdef \mbox{there is a length $n$ path 
  from $a$ to $b$ in $G_R$}.
\]
Prove that
\begin{equation}\label{RnRpnp}
R^n = R^{(n)}
\end{equation}
for all $n \in \naturals$.

\begin{solution}

\begin{proof}
By induction on $n$ with equation~\ref{RnRpnp} as induction hypothesis.

\textbf{Base case} $n=0$: We have that $a \mrel{R^0} b$ iff $a = b$ by
definition of $R^0$.  Also there is a length 0 path from $a$ to $b$ iff $a
= b$ by definition of length 0 path.  So $a \mrel{R^0} b$ iff there is a
length 0 path from $a$ to $b$.  That is, $R^0 = R^{(0)}$.

\textbf{Inductive step:} Suppose~\eqref{RnRpnp} holds for some $n\ge 0$.
We want to prove it holds with ``$n$'' replaced by $n+1$."

First consider a length $n+1$ path
\[
a=a_0,\dots,a_n,a_{n+1}=b
\]
in $G_R$.  By induction hypothesis, we can assume that $a\mrel{R^n}
a_n$.  Also, we have by definition of path in $G_R$ that $a_n \mrel{R}
b$.  Therefore,
\[
a \mrel{(R \compose R^n)} b
\]
by the definition of composition.  So $a\, R^{n+1} b$ by the recursive
definition of $R^{n+1}$.  This shows that $R^{(n+1)} \subseteq R^{n+1}$.

Conversely, suppose $a \mrel{R^{n+1}} b$.  By the definition of $R^{n+1}$,
there exists a $b'$ such that $a \mrel{R^n} b'$ and $b \mrel{R} b$.  By
the inductive hypothesis, we can assume that there is a length $n$ path in
$R$ from $a$ to $b'$.  But since $b' \mrel{R} b$, we can add $b$ to the
end of the path and obtain a length $n+1$ path from $a$ to $b$.  This
shows that $R^{n+1} \subseteq R^{(n+1)}$.

Hence, $R^{n+1} = R^{(n+1)}$, which is the exactly~\eqref{RnRpnp} with
``$n$'' replaced by $n+1$," completing the proof by induction.
\end{proof}

\end{solution}
\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput

