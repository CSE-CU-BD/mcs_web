\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_bag_of_donuts}
  \pcomment{from: S09.cp12m, S07.cp11w, S06.cp11}
\end{pcomments}

\pkeywords{

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
We are interested in generating functions for the number of different ways
to compose a bag of $n$ donuts subject to various restrictions.  For each
of the restrictions in (a)-(e) below, find a closed form for the
corresponding generating function.

\bparts

\ppart All the donuts are chocolate and there are at least 3.

\begin{solution}
\[
\ang{0, 0, 0, 1, 1, \dots, 1, \dots} \corresp \frac{x^3}{1-x}
\]
\end{solution}

\ppart All the donuts are glazed and there are at most 2.

\begin{solution}
\[
\ang{1, 1, 1, 0, 0, \dots, 0, \dots} \corresp 1+x+x^2
\]
\end{solution}

\ppart All the donuts are coconut and there are exactly 2 or there are none.

\begin{solution}
\[
\ang{1, 0, 1, 0, 0, \dots, 0, \dots} \corresp 1+x^2
\]
\end{solution}

\ppart All the donuts are plain and their number is a multiple of 4.

\begin{solution}
\[
\ang{1, 0, 0, 0, 1, 0,0,0,\dots, 1, 0,0,0, \dots} \corresp \frac{1}{1-x^4}
\]
\end{solution}

\ppart The donuts must be chocolate, glazed, coconut, or plain and:

\begin{itemize}
\item there must be at least 3 chocolate donuts, and
\item there must be at most 2 glazed, and
\item there must be exactly 0 or 2 coconut, and
\item there must be a multiple of 4 plain.
\end{itemize}

\begin{solution}
\begin{align*}
\frac{x^3}{1-x}(1+x+x^2)(1+x^2) \frac{1}{1-x^4}
  &  = \frac{x^3(1+x+x^2)(1+x^2)}%
            {(1-x)^2(1+x)(1+x^2)}\\
  & = x^3\frac{1+x+x^2}{(1-x)^2(1+x)}
\end{align*}
\end{solution}

\ppart Find a closed form for the number of ways to select $n$ donuts
subject to the constraints of the previous part.

\begin{solution}
Let
\[
G(x) \eqdef \frac{1+x+x^2}{(1-x)^2(1+x)},
\]
so the generating function for donut selections is $x^3G(x)$.
By partial fractions
\begin{equation}\label{Gp}
\frac{1+x+x^2}{(1-x)^2(1+x)} =  \frac{A}{1-x} + \frac{B}{(1-x)^2} + \frac{C}{1+x}
\end{equation}
for some constants, $A,B,C$.  We know that the coefficient of $x^n$ in the
series for ${(1-x)^2}$ is, by the Convolution Rule, the number of ways to
select $n$ items of two different kinds, namely, $\binom{n+1}{1}=n+1$, so
we conclude that the $n$th coefficient in the series for $G(x)$ is
\begin{equation}\label{coeff}
A + B(n+1) + C(-1)^n.
\end{equation}

To find $A,B,C$, we multiply both sides of~\eqref{Gp} by the denominator
$(1-x)^2(1+x)$ to obtain
\begin{equation}\label{1xx2}
1+x+x^2 =  A(1-x)(1+x) + B(1+x) + C(1-x)^2.
\end{equation}
Letting $x=1$ in~\eqref{1xx2}, we conclude that $3 = 2B$, so $B=3/2$.
Then, letting $x=-1$, we conclude $(-1)^2=C2^2$, so $C=1/4$.  Finally, letting
$x=0$, we have
\[
1= A+B+C = A+\frac{3}{2}+\frac{1}{4},
\]
so $A=-3/4$.  Then from~\eqref{coeff}, we conclude that the $n$th
coefficient in the series for $G(x)$ is
\[
-\frac{3}{4} + \frac{3(n+1)}{2} + \frac{(-1)^n}{4} = \frac{6n + 3 + (-1)^n}{4}.
\]
So the $n$th coefficient in the series for the generating function,
$x^3G(x)$, for donut selections is zero for $n<3$, and, for $n \ge 3$, is
the $(n-3)$rd coefficient of $G$, namely,
\[
\frac{6(n-3) + 3 + (-1)^{n-3}}{4} = \frac{6n -15 + (-1)^{n-1}}{4}.
\]
\end{solution}
\eparts

\end{problem}

\endinput
