\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_tournament_chain}
  \pcomment{from ps4.S10}
  \pcomment{substantially revised by ARM 3/8/11}
  \pcomment{by ARM 10/17/09 but I saw it somewhere}
\end{pcomments}

\pkeywords{
  digraphs
  relations
  ranking
  tournament
  rationals
  path
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem} %\textbf{Tournament Graphs}

%  \newcommand{\beats}{\!\rightarrow\!}

  In a round-robin tournament, every two distinct players play against
  each other just once.  For a round-robin tournament with with no
  tied games, a record of who beat whom can be described with a
  \term{tournament digraph}, where the vertices correspond to players
  and there is an edge $\diredge{x}{y}$ iff $x$ beat $y$ in their
  game.

  A \term*{ranking} is a path that includes all the players.

\begin{staffnotes}
 Paths used to be called ``simple paths'' or ``\emph{directed} simple
 paths.''
\end{staffnotes}

\bparts

\ppart Give an example of a tournament digraph with more than one
ranking.

\begin{solution}
  Let $n=3$ with edges $\diredge{u}{v}$, $\diredge{v}{w}$ and
  $\diredge{w}{u}$.  Then both~$u,v,w$ and $v,w,u$ are rankings.
\end{solution}

\ppart Prove that if a tournament digraph is a DAG, then it has at
most one ranking.  \iffalse
\hint Prove that the elements below~$u$ in any
ranking are uniquely determined.\fi

\begin{solution}
Suppose for contradiction that there are two rankings for the graph.
Since the rankings differ, there must be two players~$u \neq v$ such
that~$u$ ranks higher than $v$ in one ranking and lower than $v$ in
the other ranking.  So one ranking gives a path from~$u$ to $v$ and
the other ranking gives a path from $v$ to~$u$.

Merging these paths gives a closed \emph{walk} from~$u$ to~$u$ that
goes through $v$.  From this we would like to conclude that there is a
positive length cycle from~$u$ to~$u$.  This would contradict the fact
that the graph is a DAG, and so would complete the proof.

But having a closed walk of from~$u$ to~$u$ that goes through $v$ does
not by itself imply that there is a \emph{cycle} from from~$u$ to~$u$
that goes through $v$.  In fact, in general there may not be such a
cycle ---an example of this appears at the end of this solution.

Now there are two ways to close this loophole.  One is to observe that
\begin{lemma*}
The shortest positive length closed walk through a vertex is a cycle.
\end{lemma*}

Since a walk from from~$u$ to~$u$ that goes through $v \neq u$ must
have positive length, this Lemma implies there is a positive length
cycle from $u$ to $u$ (somewhere, not necessarily though $v$),
contradicting the fact the graph is a DAG and so completing the
overall proof.

All that remains is proving the Lemma, and the proof of the Lemma is
essentially the same as for Theorem~\bref{shortestwalk_thm} that a
shortest walk is a path.

\begin{proof} [of the Lemma]

  Suppose $\walkv{w}$ is a minimum positive length walk from~$u$
  to~$u$.  We claim $\walkv{w}$ is a cycle.

  To prove the claim, suppose to the contrary that $\walkv{w}$ is not a
  cycle.

\textbf{case} ($u$ occurs more than two times in $\walkv{w}$): This
means that
 \[
\walkv{w}= \catv{\walkv{e}}{u}{\walkv{f}}
\]
where both $\walkv{e}$ and $\walkv{f}$ have positive length.  Then
$\walkv{e}$ is a shorter positive length walk from $u$ to $u$,
contradicting the minimality of $\walkv{w}$.

\textbf{case} (some vertex $x \neq u$ occurs twice in $\walkv{w}$):
Then
\[
\walkv{w} = \catv{\catv{\walkv{e}}{x}{\walkv{f}}}{x}{\walkv{g}}
\]
for some positive length walks $\walkv{e}, \walkv{f}, \walkv{g}$.  But
then ``deleting'' $\walkv{f}$ yields a strictly shorter walk, namely
\[
\catv{\walkv{e}}{x}{\walkv{g}}
\]
is a shorter walk from~$u$ to~$u$, again contradicting the minimality
of $\walkv{w}$.
\end{proof}

The second way out of the loophole is to observe that in a tournament
graph, there must be an \emph{edge} in one direction or the other
between $u$ and $v$.  So say the edge is $\diredge{u}{v}$.  Then this
edge merged with the path from $v$ to $u$ will be a cycle (think about
why).

By the way, another workable approach to this problem is by induction
on the number of vertices, which we omit.

\begin{example*}
\begin{align*}
V & \eqdef \set{u,v,w,x},\\
E & \eqdef \set{\diredge{u}{w}, \diredge{w}{x}, \diredge{x}{u}, \diredge{v}{w}, \diredge{x}{v}},
\end{align*}
there is a path
\[
u \diredge{u}{w} w \diredge{w}{x} x \diredge{x}{v}
\]
from~$u$ to $v$, and a path
\[
v \diredge{v}{w} w \diredge{w}{x} x \diredge{x}{u} u
\]
from~$v$ to~$u$, but it is easy to see that there is no \emph{cycle}
from~$u$ to~$u$ \emph{that contains~$v$}.   (The sole edge out of
$u$ goes to $w$, and the sole edge out of~$v$ likewise goes to $w$,
so any walk from~$u$ to~$u$ that goes through~$v$ must go through $w$ at
least twice and therefore won't be a cycle.
\end{example*}


\begin{staffnotes}
  Alternative explanation after \emph{total partial orders} are
  defined:

  If it's a DAG, then its path relation defines a partial order, and
  since every pair of elements are comparable, this is in fact a total
  order.  So there's no alternative but to rank the elements from
  smallest to largest.
\end{staffnotes}

\end{solution}

\ppart\label{hasrank} Prove that every finite tournament digraph has a
ranking.

\begin{staffnotes}
\hint Induction on the size of the tournament.  Could also rephrase
the proof below by considereing a maximum length ranking (there is one
by WOP applied to $\#\text{players} - \text{ranking length}$).
\end{staffnotes}

\begin{solution}
By induction on $n$ with induction hypothesis
\[
P(n) \eqdef \text{every tournament digraph with $n$ vertices has a
  ranking.}
\]
 
\textbf{base case} $n=1$:  Trivial.

\textbf{inductive step}: Let $G$ be a tournament digraph with $n+1$
vertices.  Remove one vertex,~$v$, to obtain the subgraph, $H$, with the
$n$ remaining vertices.  Clearly, $H$ is also a tournament digraph, so by
induction hypothesis it has a ranking.  Now if the last player in this
$H$-ranking beat player~$v$, then~$v$ can be added at the end to form a
ranking in $G$.  On the other hand, if~$v$ beat the last player in the
$H$-ranking, then there will (by WOP) be a first player in the $H$-ranking
that~$v$ beats.  Inserting~$v$ just before that first player gives a
ranking for $G$.  Since $G$ was an arbitrary $n+1$ vertex tournament
graph, we conclude that $P(n+1)$ holds, which completes the proof.
\end{solution}

\ppart Give an example of a tournament with a countably infinite number of
players,$p_0,p_1,\dots$ that has no ranking.

\hint $\rationals$.

\begin{staffnotes}
Intervene if teams start to spend much time on this part.  Tell them
we mostly will focus on finite graphs, and in general, infinite
counter-examples like this are not particularly important.

On the other hand, to really understand a proof, you need to be aware
where the proof depends on finiteness (whether it needs to or not).
\end{staffnotes}

\begin{solution}
The rationals, $\rationals$, are a countable set, and specifying that
$r$ beats $s$ precisely when $r > s$ defines a tournament graph with
$\rationals$ as the set of players.

Now in any tournament graph, vertex~$u$ can come before vertex~$u$ in
some ranking only if there is a path from~$u$ to~$v$.  This implies
that if $r > s$, then $r$ must come before $s$ in \emph{any} ranking
of $\rationals$.

So suppose there was a ranking of $\rationals$ and $\diredge{r}{s}$
was an edge on the path.  This implies that $r >s$.  Now let $t$ be
any rational such that $r>t>s$.  Now in a ranking, $t$ must come
before $r$ or after $s$, which implies $t >r$ or $s>t$, a
contradicting the choice of $t$.  SO there cannot be a ranking of the 
$\rationals$ tournament.
\end{solution}

 \eparts
\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
