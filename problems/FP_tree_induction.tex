\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{FP_tree_induction}
  \pcomment{12/12/15 by Zoran & ARM}
\end{pcomments}

\pkeywords{
  structural_induction
  tree
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\redl}{\mathbf{red}}
\newcommand{\blackl}{\mathbf{black}}
\newcommand{\RBT}{\text{RBF}}

\begin{problem} \mbox{}
The set \RBT\ of \emph{Red-black trees} is defined recursively as follows:

\inductioncase{Base case(s)}:
\[
\ang{\redl}, \ang{\blackl} \in \RBT.
\]

\inductioncase{Constructor case(s)}:
$A, B$ are \RBT's, then
\begin{itemize}
\item if $A, B$ start with \blackl, then $\ang{\redl, A, B}$ is an \RBT.
\item if $A, B$ start with \redl, then $\ang{\blackl, A, B}$ is an \RBT.
\end{itemize}

Prove by structural induction that if an \RBT $T$ has $r_T$
\redl\ labels and $b_T$ \blackl\ labels and $T$ starts with \redl,
then
\[
\frac{n_T}{3} \leq r_T \leq \frac{2n_T +1}{3},
\]
where $n_T \eqdef a+b$.

\begin{solution}
The induction hypothesis will be
\begin{align*}
[T \text{ starts with } & \redl \QIMPLIES\ \frac{n_T}{3} \leq r_T \leq \frac{2n_T + 1}{3}] \QAND\\
[T \text{ starts with } & \blackll \QIMPLIES\ \frac{n_T}{3} \leq b_T \leq \frac{2n_T + 1}{3}].
\end{align*}

\inductioncase{Base case(s)}:
\begin{itemize}
\item ($T = \ang{\redl}$).  Then $r=1, b=0, n=1$ and
\[
\frac{1}{3} \leq 1 = \frac{2\cdot 0 0+1}{3}
\]
as required.
\item ($T = \ang{\blackl}$).  Now $r=0, b=1, n=1$ and the required
  inequality holds similarly.
\end{itemize}

\inductioncase{Constructor case(s)}:
\item ($T = \ang{\redl, A, B}$).  The constructor rules imply that
  $A,B$ are \RBT's that start with \blackl.  Now
\begin{align*}
\frac{n_T}{3}
  & = \frac{1 + n_A + n_B}{3}
  & = \frac{1}{3} + \frac{n_A}{3} + \frac{n_B}{3}\\\
  & \leq 1/3 + b_A + b_B
      & \text{(induction hyp.)}\\
  & = 1/3 + (n_A - r_A) + (n_B - r_B)
  & = 1/3 + (n_A + n_B) - (r_A + r_B)\\
  & \leq 1/3 + \frac{2n_A + 1}{3} + \frac{2n_B + 1}{3}
      & \text{(induction hyp.)}\\
  & = \frac{1+ (2n_A + 1) + (2n_B + 1)}{3}
  & = \frac{1+ (2(n_A + n_b + 1)}{3}
  & = \frac{1+ 2n_T}{3}\\
 + (n_A - r_A) + (n_B - r_B)\\
  & = 1/3 + (n_A + n_B) - (r_A + r_B))\\
  & = 1/3 + (n_T-1) - (r_T-1)\\
  & = 1/3 + \frac{2n_A + 1 + 2n_B + 1}{3}\\
  & = 1/3 + \frac{2(n_A + n_B +1)}{3}\\
  & = ???.
\end{align*}

\end{solution}

\end{problem}

\endinput
