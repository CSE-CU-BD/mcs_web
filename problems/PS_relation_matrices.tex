\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{PS_relation_matrices}
  \pcomment{from: S02.cp3m}
\end{pcomments}

\pkeywords{
  relation
  matrix multiplication
  composition
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
There is a useful connection between composition of relations and
matrix product.

\iffalse

Recall that the \idx{composition} of relations $R: A \to B$ and $S: B
\to C$ is the relation $S \compose R: A \to C$ defined by the rule
\[
a \mrel{(S \compose R)} c\quad \QIFF\quad \exists b.\;  (a \mrel{R} b) \QAND
(b \mrel{S} c).
\]
\fi

We can represent a relation, $R$, between two sets $A =
\set{a_1,\dots,a_n}$ and $B = \set{b_1,\dots,b_m}$ as an
$n \times m$ matrix, $M_R$, of zeroes and ones, with the
elements of $M_R$ defined by the rule
\[
M_R (i, j)=1 \quad\QIFF\quad  a_i \mrel{R} b_j .
\] 

If we represent relations as matrices in this fashion, then we can
compute the composition of two relations $R$ and $S$ by a ``boolean''
matrix multiplication, $\otimes$, of their matrices.  Boolean matrix
multiplication is the same as matrix multiplication except that
addition is replaced by $\QOR$ and multiplication is replaced by
$\QAND$.  Namely, suppose $S: B \to C$ is a binary relation with $C =
\set{c_1,\dots,c_p}$.  So $M_S$ is an $m \times p$ matrix.  Then $M_R
\otimes M_S$ is an $m \times p$ matrix defined by the
rule:
\begin{equation}\label{MRboolMS}
[M_R \otimes M_S](i,j) \eqdef \text{\large OR}_{k=1}^m [M_R(i,k) \QAND M_s(k,j)].
\end{equation}

Prove that the matrix representation, $M_{S \compose R}$, of $S
\compose R$ equals $M_R \otimes M_S$ (note the reversal of
  $R$ and $S$).

\begin{solution}
\begin{proof}

We want to prove that
\begin{equation}\label{isrj}
i \mrel{(S\compose R)} j \quad\QIFF\quad [M_R \otimes M_S](i,j)=1.
\end{equation}

Now
\begin{align*}
[M_R \otimes M_S](i,j) =1
 & \quad\QIFF\quad \text{\large OR}_{k=1}^m [M_R(i,k) \QAND M_s(k,j)] =1
     & \text{(by def.~\ref{MRboolMS} of $\otimes$)}\\
 & \quad\QIFF\quad [M_R(i,k) \QAND M_s(k,j)]=1 \text{ for some  } k, 1\leq k\leq m 
    & \text{(def. of $\QOR$)}\\
& \quad\QIFF\quad [M_R(i,k) =1] \QAND [M_s(k,j)]=1] \text{ for some  } k, 1\leq k\leq m 
    & \text{(def. of $\QAND$)}\\
& \quad\QIFF\quad i \mrel{R} k\  \QAND\ k \mrel{S} j  \text{ for some  } k, 1\leq k\leq m 
    & \text{(def. of $M_R, M_S$)}\\
& \quad\QIFF\quad i (S \compose R) j
    & \text{(def. of $S \compose R$)}.
\end{align*}

\end{proof} 
\end{solution}

\end{problem}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
