\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{FP_Fermat_primes}
  \pcomment{ARM 5/15/14}
\end{pcomments}

\pkeywords{
  number_theory
  modular_arithmetic
  Fermat_theorem
  Z_n
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}

\bparts

\ppart\label{km1zn} Prove that\footnote{Reminder: The \emph{order} of $k \in \Zmod{n}$ is the
  smallest positive $m$ such that $k^m = 1 \inzmod{n}$.}
\[
k^m = 1 \inzmod{n}\ \QIMPLIES\ \ordmod{k}{n} \divides m.
\]

\hint Take the remainder of $m$ divided by the order.

\examspace[2.5in]

\begin{solution}
\begin{align*}
1 = k^m & = k^{\qcnt{m}{\ordmod{k}{n}} \cdot \ordmod{k}{n} + \rem{m}{\ordmod{k}{n}}} \inzmod{n}\\
        & = \paren{k^{\ordmod{k}{n}}}^{\qcnt{m}{\ordmod{k}{n}}} \cdot k^{\rem{m}{\ordmod{k}{n}}}\\
        & = 1^{\qcnt{m}{\ordmod{k}{n}}} \cdot k^{\rem{m}{\ordmod{k}{n}}}  \inzmod{n}\\
        & = k^{\rem{m}{\ordmod{k}{n}}}
\end{align*}
But $0 \leq \rem{m}{\ordmod{k}{n}} < \ordmod{k}{n}$ and since
$\ordmod{k}{n}$ is the smallest positive power of $k$ equal to 1 in
$\Zmod{n}$, we must have $\rem{m}{\ordmod{k}{n}} = 0$, that is,
$\ordmod{k}{n} \divides m$.
\end{solution}

\eparts

Now suppose $p$ is a prime equal to $2^r+1$.  For example,
$2^1+1,2^2+1,2^4+1$ are such primes.

\bparts

\ppart~\label{1<k<pordmod} Conclude from part~\eqref{km1zn} that if $0 <
k < p$, then $\ordmod{k}{p}$ is a power of 2.

%\examspace[1.5in]

\begin{solution}
$p-1$ is a power of two, and therefore so are all its factors.
But by Fermat's Little Theorem,
\[
k^{p-1} = 1 \inzmod{p},
\]
and we conclude from part~\eqref{km1zn} that $\ordmod{k}{p}$ is a factor
of $p-1$.
\end{solution}

\inbook{
\ppart Prove that $\ordmod{2}{p} = 2r$ and conclude that $r$ is a power
of 2.\footnote{Numbers of the form $2^{2^k}+1$ are called \emph{Fermat
    numbers}, so we can rephrase this conclusion as saying that
  any prime of the form $2^r+1$ must actually be a Fermat number.  The
  Fermat numbers are prime for $k=1,2,3,4$, but not for $k=5$.  In
  fact, it is not known if any Fermat number with $k > 4$ is prime.}

\hint $2^k - 1$ for $k \in [1, r]$ is positive but too small to equal
$0 \inzmod{p}$.  Same for $p-(2^j + 1)$ for $j \in [1, r)$, and 
\[
p-(2^j + 1) = -2^j - 1 = 2^r(2^j) -1 = 2^{r+j} -1 \inzmod{p}.
\]

\begin{solution}
Clearly $2^{2r} = 1 \inzmod{p}$, since $2^r = -1 \inzmod{p}$ by
definition of $p$.  So the order of 2 in $\Zmod{p}$ is at most $2r$.
To show it is not $< 2r$, observe from the hint that
\[
2^1-1,2^2-1,\dots, 2^r-1 \neq 0 \inzmod{p},
\]
so
\[
2^1,2^2,\dots, 2^r \neq 1 \inzmod{p}.
\]
Likewise
\[
2^{r+1},2^{r+2},\dots, 2^{2r-1} \neq 0 \inzmod{p},
\]
and so the order of 2 in $\Zmod{p}$ is not less than $2r$.

We conclude from part~\ref{1<k<pordmod} that $2r$ is a power of 2,
which implies that $r$ is a power of 2.

Another proof\footnote{Adapted from Wikipedia, \emph{Fermat number},
  May 9, 2014.} (that does not follow the hint) is by contradiction.
If $n$ is odd, the polynomial $x^n + 1$ has $-1$ as a root, and so
$x^n + 1$ is divisible by $x + 1$.  Now suppose $r = mn$ and $n>1$ is
odd.  Now letting $x=2^m$, we have $2^r + 1 = \paren{2^m}^n +1$ is
divisible by $2^m + 1$, contradicting the fact that $2^r + 1$ is
prime.  So $r$ cannot have an odd factor greater than 1, which means
it is a power of 2.
\end{solution}
}

\eparts

\end{problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput
