\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_gambler_fair_expected_time}
  \pcomment{revised from: S08.cp13m by ARM, 5/9/10}
\end{pcomments}

\pkeywords{
  probability
  expectation
  random_walk
  gamblers_ruin
  linear-recurrence
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
In the fair Gambler's Ruin game with initial stake of $n$ dollars and
target of $T$ dollars, let $e_n$ be the number of \$1 bets the gambler makes
until the game ends (because he reaches his target or goes broke).
\begin{problemparts}
\ppart  Describe constants $a,b,c$ such that
\begin{equation}\label{enaen-1}
e_n = ae_{n-1} + be_{n-2} + c.
\end{equation}
for $1 < n < T$.
\begin{solution}
\[
e_{n}  = 2e_{n-1} - e_{n-2} - 2.
\]
That is, $a=2, b = -1, c = -2$.

This follows because
\begin{align*}
e_{n-1} & = \expcond{\#bets}{\text{gambler wins first bet}}
             \cdot \pr{\text{gambler wins first bet}}\
       & \quad + \expcond{\#bets}{\text{gambler loses first bet}}
             \cdot \pr{\text{gambler loses first bet}}
                       & \text{(Total Expectation)}\\
    & =  (1+ e_n) \cdot \frac{1}{2} + (1+ e_{n-2}) \cdot \frac{1}{2}\\
    & = \frac{2 + e_n + e_{n-2}}{2}.
\end{align*}
\end{solution}

\ppart Let $e_n$ be defined by~\eqref{enaen-1} for all $n > 1$, where
$e_0 = 0$ and $e_1 = d$ for some constant $d$.  Derive a closed form
(involving $d$) for the generating function $E(x) \eqdef \sum_0^\infty
e_nx^n$.

\begin{solution}
\[\begin{array}{rcrrrr}
E     & = & e_0 + &   e_1x + &  e_2x^2 + & \dots\\
-2xE  & = &       & -2e_0x + &-2e_1x^2 + & \dots\\
 x^2E & = &       &          &  e_0x^2 + & \dots\\
 \frac{1}{1-2x} 
      & = &  2  + &     2x + &    2x^2 + & \dots\\
\hline
E - 2x E + x^2E +\frac{1}{1-2x}
      & = &  2  + & (d + 2)x + &  0x^2 + & \dots
\end{array}\]
so
\begin{align*}
E(x) & = \frac{2 + (d + 2)x - \frac{1}{1-2x}}{1-2x+x^2}\\
     & = \frac{(1-2x)(2 + (d+2)x) - 1}{(1-2x)(1-x)^2}\\
     & = \frac{1 +(d-2)x - 2(d+2)x^2}{(1-2x)(1-x)^2}
\end{align*}
By partial fractions,
\[
E(x) = \frac{A}{1-2x} + \frac{B}{1-x} +\frac{C}{(1-x)^2}
\]
so multiplying both sides by the denominator $(1-2x)(1-x)^2$ yields
\[
1 + (d-2)x - 2(d+2)x^2 = A(1-x)^2 + B(1-2x)(1-x) + C(1-2x).
\]
Letting $x =1/2$ yields
\[
1 + (d-2)/2 - (d+2)/2 = -1 = A/4,
\]
so $A=-4$.

Letting $x =1$ yields
\[
1+ (d-2) - 2(d+2) = - C, 
\]
so $C= -d -5$.

Letting $x=0$ yields
\[
1  = A+B+C = -4 + B -d -5,
\]
so $B = d+10$.
This implies that
\[
e_n = -4\cdot2^n + d + 10  - (n+1) (d + 5)
    = -2^{n+2}  - n(d+5) +5 
\]
\TBA{WRONG! ...}

\end{solution}

\ppart\label{closeden} Find a closed form (involving $d$) for $e_n$.

\begin{solution}
\TBA{soln}
\end{solution}

\ppart Use part~\eqref{closeden} to solve for $d$.

\begin{solution}
\TBA{soln}
\end{solution}

\ppart Prove that $e_n = n(T-n)$.

\begin{solution}
\TBA{soln}
\end{solution}

\end{problemparts}

\end{problem}

\endinput
