\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{FP_marriage_modify}
  \pcomment{by Rich F09}
\end{pcomments}

\pkeywords{
 stable_matching
 stable_marriage
 mating_ritual
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}

\textbf{Stable Marriage}

Consider a \idx{stable marriage} problem with 4 boys and 4 girls. Here
are their preference rankings:

\begin{center}
\begin{tabular}{r|c} 
Alfred:    & Helen, Emily, Fiona, Grace    \\
Billy:     & Helen, Grace, Fiona, Emily    \\
Calvin:    & Grace, Helen, Emily, Fiona    \\
David:     & Helen, Grace, Emily, Fiona
\end{tabular}
\end{center}

\begin{center}
\begin{tabular}{r|c} 
Emily:     & Alfred, Calvin, David,  Billy    \\
Fiona:     & Calvin, Billy,  Alfred, David    \\
Grace:     & Calvin, Alfred, David,  Billy    \\
Helen:     & Calvin, Billy,  David,  Alfred
\end{tabular}
\end{center}

\bparts

\ppart\label{AlfredEmily} Exhibit a stable matching between these boys and girls.

\begin{solution}
  (Alfred, Emily), (Billy, Helen), (Calvin, Grace), (David, Fiona)
\end{solution}

\ppart Briefly explain why there is only one stable matching.

\begin{solution}
  Above is the boy-optimal matching from the Mating Ritual.  But this
  matching also is the result of the Ritual with boy and girl roles
  reversed, and hence is also boy-pessimal.  This implies it is the
  only possible stable matching.
\end{solution}

\ppart A machine is programmed to output three different matchings (not
necessarily stable) randomly.  What is the probability that at least one
of the three is stable?

\begin{solution}
  There are $4!$ possible matchings, so there are $\binom{4!}{3}$ sets
  consisting of three matchings.  We know that the solution to
  part~\eqref{AlfredEmily} is unique, so there is only one possible
  sequence out of the $4!$ sequences that is stable.
 
  The total number of sets of three matchings that include one stable matching
  is therefore $\binom{4!-1}{2}$ (choose 2 unstable matching), so the
  probability is:
\[
\frac{\binom{4!-1}{2}}{\binom{4!}{3}} = \frac{1}{8}
\]

Alternatively, let $S_i$ be the set of ordered triples of distinct
matchings with the $i$th component equal to the stable matching.
There are $4!$ matchings, so $\card{S_i}= (4!-1)(4!-2)$.  Also,
$S_1,S_2,S_3$ are pairwise disjoint, so the number of choices where
one of the choices is stable is the sum of the sizes of the $S_i$'s,
namely $3(4!-1)(4!-2)$.  Hence the number of \emph{sets} of three
matchings with one stable is this divided by $3!$, namely
$(4!-1)(4!-2)/2$.  So the probability of a stable match among the
three is this divided by the number of sets of three matchings, namely,
\[
\frac{(4!-1)(4!-2)/2}{\binom{4!}{3} = \frac{1}{8}
\]
\end{solution}

\iffalse too much for a final

\ppart Suppose that Billy, being a noble and good friend of David, decides
to modify his preference ranking in order to help match David with Helen.
Find a new preference ranking for Billy such that any stable matching will
have David and Helen be a couple.  Explain why there is no other stable
matching with Helen being matched with someone else.

\begin{solution}
  Any ranking with Fiona in front of Helen will make it work.
\end{solution}
\fi

\eparts
\end{problem}

\endinput
