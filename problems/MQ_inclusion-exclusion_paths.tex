\documentclass[problem]{mcs}

\begin{pcomments}
\pcomment{MQ_inclusion-exclusion_paths}
\pcomment{simplification of CP_inclusion-exclusion_paths}
\pcomment{minor variation of PS_path_counting}
\pcomment{was part of from CP_more_counting}
\end{pcomments}

\pkeywords{
  counting
  inclusion_exclsuion
  paths
  multinomial
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}

\bparts

We want to count step-by-step paths between points with integer
coordinates in three dimensions.  Let $O,a,b,c$ be the following points:
\begin{align*}
O & \eqdef (0,0,0),\\
a & \eqdef (5,10,15),\\
b & \eqdef (15,10,5),\\
c & \eqdef (10,20,30).
\end{align*}

A step may move a unit distance in the positive $x$, $y$, or $z$
direction.  For example, a step from point $a$ in the $y$ direction
leads to $(5,11,15)$.

For any set $S \subseteq \set{O,a,b,c}$ of the these points, let
\[
P_S \eqdef \text{the paths that go through all the points in } S.
\]

\ppart Express $\card{P_{a,c}}$ as a multinomial coefficient.

\examspace[1in]

\begin{solution}
There must be exactly $c_x-a_x=10-5=5$ right steps, $c_y-a_y=20-10=10$
up steps, and $c_z-a_z=30-15=15$ forward steps, for a total of 30
steps.  These steps may be taken in any order, so the number of paths
is the same as the number of permutations of the letters $R^5 U^{10}
F^{15}$, namely,
\[
\binom{30}{5,10,15}\,.
\]
\end{solution}

\ppart\label{poacpoa}  Express $\card{P_{O,a,c}}$ in terms of $\card{P_{O,a}}$ and $\card{P_{a,c}}$.

\examspace[0.5in]

\begin{solution}
\begin{equation}\label{cqcpcn}
\card{P_{O,a,c}} = \card{P_{O,a}} \cdot \card{P_{a,c}}.
\end{equation}

Every path in $P_{O,a,c}$ consists of a path in $P_{O,a}$ followed by a path in $P_{a,c}$,
and this correspondence between $P_{O,a,c}$ and $P_{O,a} \cross P_{a,c}$ is a bijection,
so~\eqref{cqcpcn} follows by the Product Rule.
\end{solution}

\ppart\label{pab0} What is $\card{P_{a,b}}$? \hfill\examrule

\begin{solution}
\[
0
\]

Since $a_x < b_x$ there is no path from $b$ to $a$.  Since $b_z < a_z$
there is no path from $a$ to $b$.  So no path can go between $a$ and $b$.
\end{solution}

\ppart Let $N$ be the paths in $P_{O,c}$ that do \emph{not} go through $a$ or $b$.
Express $\card{N}$ in terms of the sizes $\card{P_{p,q}}$ for $p,q \in \set{O,a,b,c}$.

\examspace[2in]

\begin{solution}
\begin{align*}
\card{N} & = \card{P_{O,c}} - (\card{P_{O,a,c}} + \card{P_{O,b,c}} - \card{P_{O,a,b,c}})
                &  \text{(inclusion-exclusion)}\\
& = \card{P_{O,c}} - (\card{P_{O,a}}\card{P_{a,c}} + \card{P_{O,b}}\card{P_{b,c}} - 0)
               & \text{(parts~\eqref{poacpoa} and~\eqref{pab0})}
\end{align*}
\end{solution}

\eparts
\end{problem}

\endinput
