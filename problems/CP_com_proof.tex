\documentclass[problem]{mcs}

\begin{pcomments}
  \pcomment{CP_com_proof}
  \pcomment{from: S09.cp11r}
\end{pcomments}

\pkeywords{
  combinatorial
  bijection
  binomial
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem starts here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{problem}
\bparts

\ppart Give a combinatorial proof of the
following\inhandout{, more interesting} theorem:
\begin{equation}\label{n2n-1comproof}
n 2^{n-1} = \sum_{k=1}^n k \binom{n}{k}
\end{equation}

\hint Let $S$ be the set of all length-$n$ sequences of 0's, 1's and a
single *.

\begin{solution}
Let $P \eqdef \set{0,\dots,n-1} \cross \set{0,1}^{n-1}$.  On
the one hand, there is a bijection from $P$ to $S$ by mapping $(k,x)$ to
the word obtained by inserting a * just after the $k$th bit in the
length-$n-1$ binary word, $x$.  So
\begin{equation}\label{SPn2n-1}
\card{S} = \card{P}= n 2^{n-1}
\end{equation}
by the Product Rule.

On the other hand, every sequence in $S$ contains between 1 and $n$
nonzero entries since the $*$, at least, is nonzero.  The mapping from a
sequence in $S$ with exactly $k$ nonzero entries to a pair consisting of
the set of positions of the nonzero entries and the position of the *
among these entries is a bijection, and the number of such pairs is
$\binom{n}{k}k$ by the Generalized Product Rule.
Thus, by the Sum Rule:
\[
\card{S} = \sum_{k=1}^n k \binom{n}{k}
\]
Equating this expression and the expression~\eqref{SPn2n-1} for $\card{S}$
proves the theorem.
\end{solution}

\iffalse

How would you prove it algebraically?

\begin{solution}
We calculate:
\begin{align*}
\sum_{k=1}^n k\binom{n}{k}
& =  \sum_{k=1}^n k\frac{n!}{k! (n-k)!} \\
& =  \sum_{k=1}^n \frac{n!}{(k-1)! (n-k)!} \\
& =  \sum_{k=1}^n n \frac{(n-1)!}{(k-1)! ((n-1)-(k-1))!} \\
& =  n \sum_{j=0}^{n-1} \frac{(n-1)!}{j! ((n-1)-j)!} \\
& =  n \sum_{j=0}^{n-1} \binom{n-1}{j} \\
& =  n 2^{n-1}
\end{align*}
The first three steps are algebra: replacing the binomial coefficient
with its ratio of factorials, then simplifying $k$, then trying to
form another coefficient by drawing $n$ out of $n!$ (and eventually
out of the sum). In the fourth step, we change variables, from $k$ to
$j=k-1$. In the fifth step, we recognize the new coefficient we were
after.  The final step uses the binomial theorem.
\end{solution}
\fi

\ppart Now prove~\eqref{n2n-1comproof} algebraically by applying the
Binomial Theorem to $(1+x)^n$ and taking derivatives.

\begin{solution}
By the Binomial Theorem
\[
(1 + x)^n = \sum_{k=0}^n \binom{n}{k} x^k.
\]
Taking derivatives, we get
\begin{align}
n(1 + x)^{n-1} & = \sum_{k=0}^n k\binom{n}{k} x^{k-1}\notag\\
              & = \frac{1}{x}\sum_{k=0}^n k\binom{n}{k} x^k.\label{1xsumkbnk}
\end{align}
Letting $x=1$ in~\eqref{1xsumkbnk} yields~\eqref{n2n-1comproof}.

\end{solution}

\eparts


\end{problem}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem ends here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\endinput
